!function(){"use strict";const t=document.getElementById.bind(document),e=document.getElementsByClassName.bind(document),i=(document.getElementsByTagName.bind(document),URL?t=>new URL(t,document.location).href:function(t){const e=document.createElement("a");return e.href=t,e.href}),n=(t,e)=>Math.floor(Math.random()*Math.floor(e))+t,s=Object.create(null);function r(t){return(t=i(t))in s?Promise.resolve(s[t]):new Promise(function(e,i){const n=document.createElement("script");n.onload=function(){e(s[n.src]),n.remove()},n.onerror=function(){i(),n.remove()},document.head.appendChild(n),n.src=t})}function a(t,e,i){this.x=t,this.y=e,this.z=i}window.config=function(t){s[document.currentScript.src]=t},a.prototype.dot2=function(t,e){return this.x*t+this.y*e},a.prototype.dot3=function(t,e,i){return this.x*t+this.y*e+this.z*i};var o=[new a(1,1,0),new a(-1,1,0),new a(1,-1,0),new a(-1,-1,0),new a(1,0,1),new a(-1,0,1),new a(1,0,-1),new a(-1,0,-1),new a(0,1,1),new a(0,-1,1),new a(0,1,-1),new a(0,-1,-1)],h=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],c=new Array(512),l=new Array(512);function u(t){t>0&&t<1&&(t*=65536),(t=Math.floor(t))<256&&(t|=t<<8);for(var e=0;e<256;e++){var i;i=1&e?h[e]^255&t:h[e]^t>>8&255,c[e]=c[e+256]=i,l[e]=l[e+256]=o[i%12]}}u(0);var d=.5*(Math.sqrt(3)-1),p=(3-Math.sqrt(3))/6;function f(t,e){var i,n,s=(t+e)*d,r=Math.floor(t+s),a=Math.floor(e+s),o=(r+a)*p,h=t-r+o,u=e-a+o;h>u?(i=1,n=0):(i=0,n=1);var f=h-i+p,m=u-n+p,w=h-1+2*p,g=u-1+2*p,E=l[(r&=255)+c[a&=255]],k=l[r+i+c[a+n]],y=l[r+1+c[a+1]],v=.5-h*h-u*u,x=.5-f*f-m*m,b=.5-w*w-g*g;return 70*((v<0?0:(v*=v)*v*E.dot2(h,u))+(x<0?0:(x*=x)*x*k.dot2(f,m))+(b<0?0:(b*=b)*b*y.dot2(w,g)))}const m="img/simple/",w={tile_width:64,tile_depth:32,block_height:16,player_height:128,tile_gap:2,tile_gap_z:1,noise_amplifier:1},g=["south","east","north","west"],E=g.map(t=>"player_"+t),k=["floor","block","mark","cuboid"],y={},v=Object.create(null);let x,b,T,L,S,_,R,I,O,M=!0,P=!0;function A(t=!0){M=t}function N(t=!0){P=t}function C(t){return Promise.all([async function(t){const e=t.tile_theme+"/",i=(t.player_theme||t.tile_theme)+"/",[n,s,a]=await Promise.all([e+"theme.js",i+"theme.js",m+"theme.js"].map(r)),o=Object.assign({},w,n);x=o.tile_width,b=o.tile_depth,T=o.block_height,L=o.tile_gap,S=o.tile_gap_z,_=o.noise_amplifier,R=s.player_height||o.player_height;for(const t of E)s.sprites.hasOwnProperty(t)?y[t]=D(t,s,i):n.sprites.hasOwnProperty(t)?y[t]=D(t,n,e):y[t]=D(t,a,m);for(const t of k)n.sprites.hasOwnProperty(t)?y[t]=D(t,n,e):y[t]=D(t,a,m);return Promise.all(Object.values(y).map(t=>t.load()))}(t),async function(){I=document.getElementById("world-canvas"),(O=I.getContext("2d")).mozImageSmoothingEnabled=!1,O.webkitImageSmoothingEnabled=!1,O.msImageSmoothingEnabled=!1,O.imageSmoothingEnabled=!1}()])}function D(t,e,i){let n,s;try{[n,...s]=e.images[e.sprites[t]]}catch(e){return void console.warn(`Bad theme config: No image for sprite '${t}' in ${i}`)}return s.length?new H(i+n,...s):new q(i+n)}class q{constructor(t){this.imagePath=t}async load(){this._image=await B(this.imagePath);const t=x/this._image.width;this._scaledWidth=x,this._scaledHeight=t*this._image.height,this.height=this._scaledHeight-b}draw(t,e,i){t.drawImage(this._image,e,i-this.height,this._scaledWidth,this._scaledHeight)}}class H{constructor(t,e,i,n,s,r=0,a=0){this.imagePath=t,this._crop={x:e,y:i,width:n,height:s};const o=x/n;this._scaledWidth=x,this._scaledHeight=o*s,this.height=this._scaledHeight-b,this.xOffset=r,this.yOffset=a}async load(){this._image=await B(this.imagePath)}draw(t,e,i){t.drawImage(this._image,this._crop.x,this._crop.y,this._crop.width,this._crop.height,e+this.xOffset,i-this.height-this.yOffset,this._scaledWidth,this._scaledHeight)}}function B(t){return t in v?v[t]:v[t]=new Promise(function(e){const i=new Image;i.onload=function(){e(i)},i.src=t})}const j=10,U="IDENTIFIER",z="INTEGER",W="NOT",F="IF",G="THEN",$="ELSE",Z="WHILE",K="DO",J="REPEAT",Q="TIMES",V="PROGRAM",X="ROUTINE",Y="LPAREN",tt="RPAREN",et="ASTERISC",it="WHITESPACE",nt="EOF",st=Object.freeze({IDENTIFIER:U,INTEGER:z,NOT:W,IF:F,THEN:G,ELSE:$,WHILE:Z,DO:K,REPEAT:J,TIMES:Q,PROGRAM:V,ROUTINE:X,LPAREN:Y,RPAREN:tt,DOT:"DOT",ASTERISC:et,WHITESPACE:it,EOF:nt});class rt{constructor(t,e,i,n){this.type=t,this.value=e,this.line=i,this.column=n}toString(){return this.type+"("+this.value+")"}}const at={wenn:F,if:F,dann:G,then:G,sonst:$,else:$,solange:Z,while:Z,tue:K,do:K,nicht:W,not:W,wiederhole:J,repeat:J,mal:Q,times:Q,programm:V,program:V,anweisung:X,routine:X},ot=Object.keys(at),ht={"(":Y,")":tt,".":"DOT","*":et},ct=Object.keys(ht),lt=/\s/,ut=/[0-9]/,dt=/[A-Za-z_]/i;class pt{constructor(t,e=!1){this.text=t,this.includeWhitespace=e,this.position=0,this.line=1,this.column=1}[Symbol.iterator](){return this}next(){const t=this.nextToken();return t.type===nt?{done:!0}:{value:t,done:!1}}nextToken(){let t="";for(;this.position<this.text.length&&lt.test(this.text[this.position]);)t+=this.text[this.position],"\n"===this.text[this.position]&&(this.column=0,this.line++),this.position++,this.column++;if(t.length&&this.includeWhitespace)return new rt(it,t,this.line,this.column);const e=this.text[this.position];if(ct.includes(e))return this.position++,this.column++,new rt(ht[e],e,this.line,this.column);let i="";for(;this.position<this.text.length&&ut.test(this.text[this.position]);)i+=this.text[this.position],this.position++,this.column++;if(i.length)return new rt(z,+i,this.line,this.column);let n="";for(;this.position<this.text.length&&dt.test(this.text[this.position]);)n+=this.text[this.position],this.position++,this.column++;if(n.length){const t=n.toLowerCase();return ot.includes(t)?new rt(at[t],n,this.line,this.column):new rt(U,n,this.line,this.column)}if(this.position>=this.text.length)return new rt(nt,"",this.line,this.column);throw new Error("Syntax Error: Could not read next token in line "+this.line+" column "+this.column+".")}get remainingText(){return this.text.slice(this.position)}}class ft{constructor(t){this.tokens=t,this.depth=0,this.forward()}forward(){this.currentToken=this.tokens.nextToken()}eat(t){if(this.currentToken.type!==t)throw new Error("Syntax Error on line "+this.tokens.line+": Unexpected token "+this.currentToken+", was expecting "+t+".");this.forward()}readToken(...t){if(t.includes(this.currentToken.type)){const t=this.currentToken.value;return this.forward(),t}throw new Error("Syntax Error on line "+this.tokens.line+": Unexpected token "+this.currentToken+". Expected any of "+t)}readExpression(){switch(this.currentToken.type){case U:return this.readCall();case z:{const t=+this.currentToken.value;return this.forward(),{type:z,value:t}}case W:return this.forward(),{type:W,expression:this.readExpression()};case Y:{const t=this.readExpression();return this.eat(tt),t}}}readCall(){const t={type:U,identifier:this.currentToken.value,line:this.currentToken.line};return this.forward(),this.currentToken.type===Y&&(this.forward(),this.currentToken.type===tt?this.forward():(t.argument=this.readExpression(),this.eat(tt))),t}readSequence(){const t=[],e=[et,$,nt];for(this.depth++;!e.includes(this.currentToken.type);)t.push(this.readStatement());return this.depth--,t}readStatement(){const t={type:this.currentToken.type};switch(this.currentToken.type){case U:return this.readCall();case F:return this.forward(),t.condition=this.readExpression(),this.eat(G),t.sequence=this.readSequence(),this.currentToken.type===$&&(this.forward(),t.alternative=this.readSequence()),this.eat(et),this.eat(F),t;case Z:return this.forward(),t.condition=this.readExpression(),this.eat(K),t.sequence=this.readSequence(),this.eat(et),this.eat(Z),t;case J:return this.forward(),this.currentToken.type===Z?(t.type=Z,this.forward(),t.condition=this.readExpression()):(t.count=this.readExpression(),this.eat(Q)),t.sequence=this.readSequence(),this.eat(et),this.eat(J),t;case V:if(this.depth>1)throw new Error("Parse Error on line "+this.tokens.line+": Can't define program in nested context.");return this.forward(),t.sequence=this.readSequence(),this.eat(et),this.eat(V),t;case X:if(this.depth>1)throw new Error("Parse Error on line "+this.tokens.line+": Can't define routine in nested context.");return this.forward(),t.identifier=this.readToken(U),t.sequence=this.readSequence(),this.eat(et),this.eat(X),t}throw new Error("Parse Error on line "+this.tokens.line+": Unexpected token "+this.currentToken+".")}}const mt=Object.create(null);mt[st.IDENTIFIER]="identifier",mt[st.INTEGER]="number",[st.NOT,st.IF,st.THEN,st.ELSE,st.WHILE,st.DO,st.REPEAT,st.TIMES,st.PROGRAM,st.ROUTINE].forEach(t=>mt[t]="keyword"),[st.LPAREN,st.RPAREN,st.DOT,st.ASTERISC].forEach(t=>mt[t]="punctuation");var wt=new class{constructor(t,e="    "){this.indentation=e,this.unindenRegex=new RegExp("^"+e.split("").join("?")+"?","gm"),this.scrollbox=t.getElementsByClassName("editor-scrollbox")[0],this.highlighted=t.getElementsByClassName("editor-highlight")[0];const i=this.textarea=t.getElementsByClassName("editor-textarea")[0],n=this.caretLayer=t.getElementsByClassName("editor-caret-layer")[0];this.beforeCaret=n.appendChild(document.createElement("span")),this.caret=n.appendChild(document.createElement("span")),this.caret.classList.add("editor-caret"),this.selection=n.appendChild(document.createElement("span")),this.selection.classList.add("editor-selection"),i.addEventListener("keydown",t=>{"Tab"!==t.key&&9!==t.keyCode||(t.preventDefault(),t.shiftKey?this.unindent():this.indent())}),i.addEventListener("input",this.update.bind(this));const s=this.updateCaret.bind(this),r=()=>setTimeout(s,0);i.addEventListener("keypress",r),i.addEventListener("keydown",r),i.addEventListener("mousedown",function(){this.addEventListener("mousemove",r),r()}),i.addEventListener("mouseup",function(){this.removeEventListener("mousemove",r),r()}),this.update()}get value(){return this.textarea.value}set value(t){this.textarea.value=t,this.update()}update(){this.highlighted.innerHTML=function(t){let e="",i=1;const n=()=>`</span></span><span class="line"><span class="lineno">${++i}</span><span>`,s=new pt(t,!0);try{for(const t of s)t.type in mt?e+=`<span class="token ${mt[t.type]}">${t.value}</span>`:e+=t.value.replace(/ /g,"·").replace(/\n/g,n)}catch(t){e+=s.remainingText.replace(/\n/g,n)}return`<span class="line"><span class="lineno">1</span><span>${e}</span></span>`}(this.textarea.value),this.textarea.style.height=this.highlighted.offsetHeight+"px",this.updateCaret()}updateCaret(){const{value:t,selectionDirection:e,selectionEnd:i,selectionStart:n}=this.textarea;this.beforeCaret.innerHTML=t.slice(0,n),this.selection.innerHTML=t.slice(n,i),this.caret.insertAdjacentElement("forward"===e?"beforebegin":"afterend",this.selection),this.caret.classList.remove("blink"),requestAnimationFrame(()=>this.caret.classList.add("blink"))}markLine(t){for(const t of this.highlighted.getElementsByClassName("current"))t.classList.remove("current");this.highlighted.children[t-1].classList.add("current")}indent(){const{value:t,selectionStart:e,selectionEnd:i,selectionDirection:n}=this.textarea;if(t.slice(e,i).includes("\n")){const s=t.lastIndexOf("\n",e-1)+1;let r=t.indexOf("\n",i);r<0&&(r=t.length);const a=t.slice(s,r).replace(/^/gm,this.indentation);this.textarea.value=t.slice(0,s)+a+t.slice(r),this.textarea.selectionStart=e+this.indentation.length,this.textarea.selectionEnd=s+a.length-(r-i),this.textarea.selectionDirection=n}else{let n=this.indentation;if("\t"!==n){const i=t.lastIndexOf("\n",e)+1,s=n.length-(e-i)%n.length;n=n.substr(0,s)}this.textarea.value=t.slice(0,e)+n+t.slice(i),this.textarea.selectionStart=this.textarea.selectionEnd=e+n.length}this.update()}unindent(){const{value:t,selectionStart:e,selectionEnd:i,selectionDirection:n}=this.textarea,s=t.lastIndexOf("\n",e-1)+1;let r=t.indexOf("\n",i);r<0&&(r=t.length);let a=null;const o=t.slice(s,r).replace(this.unindenRegex,function(t){return null===a&&(a=t.length),""});this.textarea.value=t.slice(0,s)+o+t.slice(r),this.textarea.selectionStart=Math.max(s,e-a),this.textarea.selectionEnd=Math.max(s+o.lastIndexOf("\n")+1,i-r+s+o.length),this.textarea.selectionDirection=n,this.update()}}(e("editor")[0]);const gt={linksdrehen:"turnLeft",rechtsdrehen:"turnRight",schritt:"step","schrittzurück":"stepBackwards",hinlegen:"placeBlock",aufheben:"takeBlock",markesetzen:"placeMark","markelöschen":"takeMark",istwand:"isLookingAtEdge"},Et=new class{constructor(t){this.runtime=t,this.routines=Object.create(null)}interrupt(){this._interrupted=!0}async run(t){const e=new pt(t),i=new ft(e).readSequence();this._interrupted=!1,await this.visitSequence(i)}async visitSequence(t){for(const e of t)await this.visitStatement(e)}async visitStatement(t){switch(t.type){case U:if(this._interrupted)return;if(t.identifier in this.routines){if(this.depth>j)throw new Error("RunTime Error: Maximum recursion depth ("+j+") exceeded.");await this.visitSequence(this.routines[t.identifier])}else await this.runtime.execute(t.identifier,!1,t.line);break;case F:await this.visitExpression(t.condition)?await this.visitSequence(t.sequence):t.alternative&&await this.visitSequence(t.alternative);break;case Z:for(;await this.visitExpression(t.condition);)await this.visitSequence(t.sequence);break;case J:{const e=await this.visitExpression(t.count);for(let i=0;i<e;i++)await this.visitSequence(t.sequence);break}case V:await this.visitSequence(t.sequence);break;case X:this.routines[t.identifier]=t.sequence;break;default:throw new Error(`Unimplemented statement type ${t.type}`)}}async visitExpression(t){switch(t.type){case z:return+t.value;case U:return this.runtime.evaluate(t.identifier);case W:return!await this.visitExpression(t.expression);default:throw new Error("Unimplemented expression type")}}}({execute:Pt,evaluate:At});let kt,yt,vt=100,xt=!0,bt=!0,Tt=Promise.resolve(),Lt=function(){};const St=t=>new Promise(function(e){yt=e,setTimeout(e,t)});function _t(t){kt=t,Rt()}function Rt(){!function({width:t,length:e,height:i,player:n,tiles:s,seed:r}){let a=.5*(t+e)*(x+2*L),o=.5*(t+e)*(b+1*L)+i*T+R;I.width!==a&&(I.width=a),I.height!==o&&(I.height=o),O.clearRect(0,0,I.width,I.height),P&&u(r);const h=.5*(e-1)*(x+2*L);let c,l,d;for(let r=0;r<t;++r)for(let t=0;t<e;++t){c=.5*(-t+r)*(x+2*L)+L+h,l=.5*(t+r)*(b+1*L)-.5*L+i*T+R;const a=s[r*e+t];if(d=0,P&&(d+=5*_*f(r/10,t/10)+_*f(r/3,t/3)),y.floor.draw(O,c,l-d),d+=y.floor.height+S,a.cuboid)y.cuboid.draw(O,c,l-d),d+=y.cuboid.height+S;else{for(let t=0;t<a.blocks;++t)y.block.draw(O,c,l-d),d+=y.block.height+S;a.mark&&(y.mark.draw(O,c,l-d),d+=y.mark.height+S)}M&&n.x===r&&n.y===t&&y["player_"+g[n.orientation]].draw(O,c,l-d)}}(kt)}function It(t){vt=t}function Ot(){bt&&(bt=!1,Tt=new Promise(t=>Lt=t))}function Mt(){bt=!0,Lt()}async function Pt(t,e=!1,i=null){bt||await Tt,null!==i&&wt.markLine(i),At(t),Rt(),xt&&!e&&await St(vt)}function At(t){const e=gt[t.toLowerCase()];if(!e)throw new Error(`RunTime Error: ${t} is not defined.`);return kt[e]()}class Nt{constructor(t,e,i,s,r,a){this.width=t,this.length=e,this.height=i,this.seed=s||n(1<<31,-(1<<31)),this.player=r||{x:0,y:0,orientation:0},this.tiles=a||Array.from({length:t*e},()=>({blocks:0,mark:!1}))}static move({x:t,y:e,orientation:i},n=1,s=0){switch(i){case 0:t+=s,e+=n;break;case 1:t+=n,e+=s;break;case 2:t-=s,e-=n;break;case 3:t-=n,e-=s}return[t,e]}contains(t,e){return t>=0&&e>=0&&t<this.width&&e<this.length}isLookingAtEdge(){return!this.contains(...Nt.move(this.player))}step(t=1,e=0){const i=this.tiles[this.player.x*this.length+this.player.y].blocks,[n,s]=Nt.move(this.player,t,e);if(!this.contains(n,s))throw new Error("invalid move: out of world");const r=this.tiles[n*this.length+s];if(1<Math.abs(i-r.blocks))throw new Error("invalid move: jump too high");if(r.cuboid)throw new Error("invalid move: cuboid");[this.player.x,this.player.y]=[n,s]}stepBackwards(){this.step(-1)}turnLeft(){this.player.orientation=(this.player.orientation+1)%4}turnRight(){this.player.orientation=(this.player.orientation+3)%4}placeBlock(){const[t,e]=Nt.move(this.player);if(!this.contains(t,e))throw new Error("invalid action: out of world");const i=this.tiles[t*this.length+e];if(i.cuboid)throw new Error("invalid action: block on cuboid");if(i.blocks>=this.height)throw new Error("invalid action: building too high");i.blocks++}takeBlock(){const[t,e]=Nt.move(this.player);if(!this.contains(t,e))throw new Error("invalid action: out of world");const i=this.tiles[t*this.length+e];if(i.blocks<=0)throw new Error("invalid action: no blocks");i.blocks--}placeMark(){const t=this.tiles[this.player.x*this.length+this.player.y];if(t.mark)throw new Error("invalid action: already has a mark");t.mark=!0}takeMark(){const t=this.tiles[this.player.x*this.length+this.player.y];if(!t.mark)throw new Error("invalid action: no mark");t.mark=!1}}function Ct(t){return function(t){return new Promise(function(e){const i=new FileReader;i.onload=function(){e(i.result)},i.readAsText(t)})}(t).then(Dt)}function Dt(t){const e=t.split(/\s+/),[i,n,s,r,a,o]=e.slice(1,7).map(t=>+t),h=[];for(let t=0;t<i*n;t++){const i=7+(s+1)*t,n=e.slice(i,i+s+1),r={blocks:n.filter(t=>"z"===t).length,mark:"m"===n[n.length-1]};n.includes("q")&&(r.cuboid=!0),h.push(r)}return new Nt(i,n,s,0,{x:r,y:a,orientation:o},h)}const qt={ArrowLeft:"LinksDrehen",a:"LinksDrehen",ArrowRight:"RechtsDrehen",d:"RechtsDrehen",ArrowUp:"Schritt",w:"Schritt",ArrowDown:"SchrittZurück",s:"SchrittZurück",h:"Hinlegen",H:"Aufheben",m:"MarkeSetzen",M:"MarkeLöschen"},Ht=t("width-input"),Bt=t("length-input"),jt=t("height-input"),Ut=t("file-input"),zt=t("world-simulation-speed"),Wt=t("world-show-player"),Ft=t("world-show-flat"),Gt=t("status-text");function $t(t){t&&t.preventDefault(),_t(new Nt(+Ht.value,+Bt.value,+jt.value))}function Zt(t){t&&t.preventDefault(),Ct(Ut.files[0]).then(_t)}function Kt(){t("world-create-form").addEventListener("submit",$t),t("world-load-form").addEventListener("submit",Zt),Ut.addEventListener("change",Zt),Wt.addEventListener("change",function(){A(Wt.checked),Rt()}),A(Wt.checked),Ft.addEventListener("change",function(){N(!Ft.checked),Rt()}),N(!Ft.checked),zt.addEventListener("change",function(){It(Math.pow(10,4-zt.value))}),It(Math.pow(10,4-zt.value));let e=!1;addEventListener("keydown",async function(t){if(t.defaultPrevented||t.target instanceof HTMLTextAreaElement)return;const i=qt[t.key];if(i){if(t.preventDefault(),e)return;e=!0;try{await Pt(i.toLowerCase(),!0),Gt.innerHTML="",Gt.classList.remove("status-error")}catch(t){Gt.innerHTML=t.message,Gt.classList.add("status-error")}finally{e=!1}}});const i=t("run-button"),n=t("stop-button"),s=t("step-button"),r=t("unpause-button"),a=t("pause-button"),o=(...t)=>t.map(t=>t.removeAttribute("disabled")),h=(...t)=>t.map(t=>t.setAttribute("disabled","disabled"));h(n),h(s),h(a),h(r),i.addEventListener("click",async function(t){t.preventDefault(),h(i),o(n,s,a),Gt.innerHTML="",Gt.classList.remove("status-error"),Gt.innerHTML="RUNNING.";try{await async function(t){xt=!0,Mt(),await Et.run(t)}(wt.value)}catch(t){Gt.innerHTML=t.message,Gt.classList.add("status-error")}finally{o(i),h(n,s,a,r)}}),n.addEventListener("click",function(t){t.preventDefault(),xt=!1,Et.interrupt(),yt(),Gt.innerHTML="STOPPED."}),s.addEventListener("click",function(t){t.preventDefault(),async function(){if(bt)yt();else{const t=xt;xt=!1,Mt(),await Tt,Ot(),xt=t}}()}),a.addEventListener("click",function(t){t.preventDefault(),Ot(),Gt.innerHTML="PAUSED.",h(a),o(r)}),r.addEventListener("click",function(t){t.preventDefault(),Mt(),Gt.innerHTML="RUNNING.",h(r),o(a)}),$t(),fetch("BOT.kdp").then(t=>t.text()).then(t=>wt.value=t)}r("config.js").then(t=>C(t).then(Kt))}();
